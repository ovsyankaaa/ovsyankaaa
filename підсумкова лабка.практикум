from tkinter import *
from data import *
import matplotlib.pyplot as plt
import xlsxwriter as xw
from prettytable import PrettyTable as pt
import os

def tabl():

        myTable = pt([u'Підприємство', u'Код виду основних засобів', u'Залишок на 1.01.2018', u'Надійшло у 2018', u'Вибуток у 2018'])
        myTable.title =(u'Аналіз усіх коштів')
        myTable.add_row([u"Універсам 22", "1", "44 048,00" , "500,00", "200,00"])
        myTable.add_row([u"Дніпрянка", "1", "22 456,00", "365,00", "123,00"])
        myTable.add_row([u"Універсам 22", "2", "5 564,00", "2 571,00", "135,00"])
        myTable.add_row([u"Дніпрянка", "2", "10 087,00", "15 972,00", "58,00"])
        myTable.add_row([u"Універсам 22", "3", "0,00", "0,00", "0,00"])
        myTable.add_row([u"Дніпрянка", "3", "206,00", "34,00", "50,00"])
        myTable.add_row([u"Універсам 22", "4", "116,00", "64,00", "23,00"])
        myTable.add_row([u"Дніпрянка", "4", "34,00", "23,00", "25,00"])

        print(myTable)
        table_txt = myTable.get_string()
        with open('table.txt','w', encoding='utf-8') as file:
            file.write(table_txt)

def grafic():

    money_univ1 = [44048, 500, 200]
    money_univ2 = [22456, 365, 123]
    money_univ3 = [5564, 2571, 135]
    money_univ4 = [10087, 15972, 58]
    money_dnipr1 = [0, 0, 0]
    money_dnipr2 = [206, 34, 50]
    money_dnipr3 = [116, 64, 23]
    money_dnipr4 = [34, 23, 25]
    acts = [u'Залишок 2018', u'Надійшло 2018', u'Вибуток 2018']

    plt.plot(acts, money_univ1, 'r', label = u"Універсам 22(1)")
    plt.plot(acts, money_univ2, 'b', label = u"Універсам 22(2)")
    plt.plot(acts, money_univ3, 'g', label = u"Універсам 22(3)")
    plt.plot(acts, money_univ4, 'y', label = u"Універсам 22(4)")
    plt.plot(acts, money_dnipr1, 'k', label = u"Дніпрянка(1)")
    plt.plot(acts, money_dnipr2, 'm', label = u"Дніпрянка(2)")
    plt.plot(acts, money_dnipr3, 'c', label = u"Дніпрянка(3)")
    plt.plot(acts, money_dnipr4, 'y', label = u"Дніпрянка(4)")
    plt.xlabel("Дії")
    plt.ylabel("Кошти")
    plt.legend()
    plt.grid(True)
    plt.show()

def tabexc():

    wbTab1 = xw.Workbook('tabb.xlsx')
    wsTab1=wbTab1.add_worksheet('t')
    os.system('final.xlsx')

#шутка-минутка : едут армяни в колясках по пустыне и видят лампу.Трут ее.вылетает Джин и говорит:"У вас 1 желание"Они говорят:"Хотим ходить"Джин говорит:"Держите нарды"

    a = (
    [u'Підприємство', u'Код виду основних засобів', u'Залишок на 1.01.2018', u'Надійшло у 2018', u'Видобуток у 2018'],
    [u"Універсам 22","1", "44 048,00" , "500,00", "200,00"],
    [u"Дніпрянка", "1", "22 456,00", "365,00", "123,00"],
    [u"Універсам 22", "2", "5 564,00", "2 571,00", "135,00"],
    [u"Дніпрянка", "2", "10 087,00", "15 972,00", "58,00"],
    [u"Універсам 22","3", "0,00", "0,00", "0,00"],
    [u"Дніпрянка","3", "206,00", "34,00", "50,00"],
    [u"Універсам 22", "4", "116,00", "64,00", "23,00"],
    [u"Дніпрянка", "4", "34,00", "23,00", "25,00"], 
    )
    row_number = 0
    col_number = 0

    for name, code, remain, become, educt  in a:
        wsTab1.write(row_number,col_number, name)
        wsTab1.write(row_number, col_number +1, code)
        wsTab1.write(row_number,col_number+2, remain)
        wsTab1.write(row_number,col_number+3, become)
        wsTab1.write(row_number,col_number+4, educt)
        row_number+=1

    wbTab1.close()

def dovidn():

    dovTab = pt([u'Код підприємства',u'Назва підприємства'])
    dovTab.title= u'Довідник підприємтв'
    dovTab.add_row(['1',u'Універсам 22'])
    dovTab.add_row(['1',u'Дніпрянка'])
    dovTab.add_row(['2',u'Універсам 22'])
    dovTab.add_row(['2',u'Дніпрянка'])
    dovTab.add_row(['3',u'Універсам 22'])
    dovTab.add_row(['3',u'Дніпрянка'])
    dovTab.add_row(['4',u'Універсам 22'])
    dovTab.add_row(['4',u'Дніпрянка'])
    print(dovTab)

def btn1_cl():
    for x in dt :
        if x[1]==1 :
            print(x[0],',',x[2],',',x[3],',',x[4],',', u"Будівлі")

def btn2_cl():
    for x in dt :
        if x[1]==2:
            print(x[0],',',x[2],',',x[3],',',x[4],',', u"Машини та обладнання")
            
def btn3_cl():
    for x in  dt :
        if x[1]==3 :
            print(x[0],',',x[2],',',x[3],',',x[4],',',u"Транспортні засоби")

def btn4_cl():
    for x in  dt :
        if x[1]==4 :
            print(x[0],',',x[2],',',x[3],',',x[4],',',u"Інструмент та інвентар")

root = Tk()
root.title(u"Аналіз коштів")
root.geometry("200x200")
root.resizable(False,False)

frame = Frame(root, bg = '#C2B280')
frame.place(relheight=1, relwidth=1, relx=0, rely=0)
                  
btn = Button(frame, text=(u"Табличка в консолі"),  bg = '#C2B280', command = tabl)
btn.place(x=105, y=10, width=400, height=35)

btn1 = Button(frame, text=(u"графік"),  bg = '#C2B280', command = grafic)
btn1.place(x=105, y=40, width=400, height=35)

btn2 = Button(frame, text=(u"Табличка в excel"),  bg = '#C2B280', command = tabexc)
btn2.place(x=105, y=70, width=400, height=35)

btn7 = Button(frame, text=(u"'Довідник підприємств' та аналіз за його кодом:"),  bg = '#C2B280', command = dovidn)
btn.place(x=105, y=100, width=400, height=35)

btn3 = Button(frame, text=("1"),  bg = '#C2B280', command = btn1_cl)
btn.place(x=105, y=130, width=400, height=35)

btn4 = Button(frame, text=("2"),  bg = '#C2B280', command = btn2_cl)
btn.place(x=105, y=170, width=400, height=35)

btn5 = Button(frame, text=("3"),  bg = '#C2B280', command = btn3_cl)
btn.place(x=105, y=200, width=400, height=35)

btn6 = Button(frame, text=("4"),  bg = '#C2B280', command = btn4_cl)
btn.place(x=105, y=230, width=400, height=35)
